local player = game.Players.LocalPlayer
local rs = game:GetService("ReplicatedStorage")
local run = game:GetService("RunService")
local input = game:GetService("UserInputService")

local char = player.Character or player.CharacterAdded:Wait()
local hum = char:WaitForChild("Humanoid")
local root = char:WaitForChild("HumanoidRootPart")

local anims = rs:WaitForChild("Animations")
local events = rs:WaitForChild("Events")
local punchEvent = events:WaitForChild("Punch")


local punchAnims = {}
for i = 1, 5 do
	table.insert(punchAnims, hum:LoadAnimation(anims:WaitForChild("combat" .. i)))
end


local delayEntreGolpes = 1.3       
local velocidadAnimacion = 8      

local combo = 0
local puedeAtacar = true
local tocandoPantalla = false


run.RenderStepped:Connect(function()
	if tocandoPantalla and puedeAtacar then
		puedeAtacar = false

		combo += 1
		if combo > 5 then combo = 1 end

		local anim = punchAnims[combo]
		anim:Play(0.1, 1, 0.3)
		anim:AdjustSpeed(velocidadAnimacion)

		
		punchEvent:FireServer(0, 0.1, combo)

		task.delay(delayEntreGolpes, function()
			puedeAtacar = true
		end)
	end
end)

 
input.TouchTapInWorld:Connect(function(pos, state)
	tocandoPantalla = state
end)


input.InputBegan:Connect(function(inputObj, processed)
	if processed then return end
	if inputObj.UserInputType == Enum.UserInputType.MouseButton1 then
		tocandoPantalla = true
	end
end)

input.InputEnded:Connect(function(inputObj)
	if inputObj.UserInputType == Enum.UserInputType.MouseButton1 then
		tocandoPantalla = false
	end
end)
