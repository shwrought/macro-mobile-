local player = game.Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

-- Esperar por personaje
local char = player.Character or player.CharacterAdded:Wait()
local humanoid = char:WaitForChild("Humanoid")
local root = char:WaitForChild("HumanoidRootPart")

-- Recursos del juego
local Animations = ReplicatedStorage:WaitForChild("Animations")
local Events = ReplicatedStorage:WaitForChild("Events")
local PunchEvent = Events:WaitForChild("Punch")

-- Cargar animaciones de combate
local punchAnims = {}
for i = 1, 5 do
	local anim = Animations:FindFirstChild("combat" .. i)
	if anim then
		table.insert(punchAnims, humanoid:LoadAnimation(anim))
	end
end

-- Configuraci√≥n
local golpeDelay = 0.10          -- ‚è±Ô∏è Tiempo entre golpes
local velocidadAnim = 1.0        -- üéûÔ∏è Velocidad visible de la animaci√≥n

local combo = 0
local puedeGolpear = true
local tocar = false  -- true cuando el jugador hace TAP o clic

-- Funci√≥n para atacar
local function atacar()
	if puedeGolpear and tocar then
		puedeGolpear = false
		combo += 1
		if combo > 5 then combo = 1 end

		-- Ejecutar animaci√≥n
		local anim = punchAnims[combo]
		if anim then
			anim:Play(0.1, 1, 0.3)
			anim:AdjustSpeed(velocidadAnim)
		end

		-- üîπ Golpe normal (no cargado)
		PunchEvent:FireServer(0, 0.1, combo)

		task.delay(golpeDelay, function()
			puedeGolpear = true
			atacar() -- Reintenta si a√∫n est√° tocando
		end)
	end
end

-- Mobile: Tap en pantalla
UserInputService.TouchStarted:Connect(function()
	tocar = true
	atacar()
end)

UserInputService.TouchEnded:Connect(function()
	tocar = false
end)

-- PC: Clic izquierdo
UserInputService.InputBegan:Connect(function(input, processed)
	if processed then return end
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		tocar = true
		atacar()
	end
end)

UserInputService.InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		tocar = false
	end
end)
