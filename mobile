-- ✅ Totalmente funcional en MOBILE y PC

local player = game.Players.LocalPlayer
local rs = game:GetService("ReplicatedStorage")
local run = game:GetService("RunService")
local input = game:GetService("UserInputService")

local char = player.Character or player.CharacterAdded:Wait()
local hum = char:WaitForChild("Humanoid")
local root = char:WaitForChild("HumanoidRootPart")

local anims = rs:WaitForChild("Animations")
local events = rs:WaitForChild("Events")
local punchEvent = events:WaitForChild("Punch")

-- 🔄 Cargar animaciones de combate
local punchAnims = {}
for i = 1, 5 do
	table.insert(punchAnims, hum:LoadAnimation(anims:WaitForChild("combat" .. i)))
end

-- ⚙️ CONFIGURACIÓN
local delayEntreGolpes = 1.5          -- 🔁 Tiempo entre golpes
local velocidadAnimacion = 1.0         -- 🎞️ Velocidad de animación

local combo = 0
local puedeAtacar = true
local tocandoPantalla = false

-- 🔁 Loop de ataque automático mientras tocas o clickeas
run.RenderStepped:Connect(function()
	if tocandoPantalla and puedeAtacar then
		puedeAtacar = false

		combo += 1
		if combo > 5 then combo = 1 end

		local anim = punchAnims[combo]
		anim:Play(0.1, 1, 0.3)
		anim:AdjustSpeed(velocidadAnimacion)

		-- 👊 Golpe normal (sin carga)
		punchEvent:FireServer(0, 0.1, combo)

		task.delay(delayEntreGolpes, function()
			puedeAtacar = true
		end)
	end
end)

-- 📱 MOBILE: Detectar tap (activar solo durante un frame)
input.TouchTapInWorld:Connect(function()
	tocandoPantalla = true
	task.delay(0.2, function()  -- Solo permite un golpe por tap
		tocandoPantalla = false
	end)
end)

-- 🖱️ PC: Mouse click sostenido
input.InputBegan:Connect(function(inputObj, processed)
	if processed then return end
	if inputObj.UserInputType == Enum.UserInputType.MouseButton1 then
		tocandoPantalla = true
	end
end)

input.InputEnded:Connect(function(inputObj)
	if inputObj.UserInputType == Enum.UserInputType.MouseButton1 then
		tocandoPantalla = false
	end
end)
