-- ✅ Mobile Combat: Golpea 1 vez por tap, sin spam

local player = game.Players.LocalPlayer
local rs = game:GetService("ReplicatedStorage")
local input = game:GetService("UserInputService")

local char = player.Character or player.CharacterAdded:Wait()
local hum = char:WaitForChild("Humanoid")
local root = char:WaitForChild("HumanoidRootPart")

local anims = rs:WaitForChild("Animations")
local events = rs:WaitForChild("Events")
local punchEvent = events:WaitForChild("Punch")

-- 🔁 Animaciones de combate
local punchAnims = {}
for i = 1, 5 do
	table.insert(punchAnims, hum:LoadAnimation(anims:WaitForChild("combat" .. i)))
end

-- ⚙️ CONFIGURACIÓN
local velocidadAnim = 5           -- 🎞️ Animación visual
local delayGolpe = 5              -- 🕒 Delay mínimo realista
local combo = 1
local puedeAtacar = true

-- 👊 Función para golpear 1 vez
local function Golpear()
	if not puedeAtacar then return end
	puedeAtacar = false

	-- Ejecutar animación y golpe
	local anim = punchAnims[combo]
	anim:Play(0.1, 1, 0.3)
	anim:AdjustSpeed(velocidadAnim)

	punchEvent:FireServer(0, 0.1, combo)

	combo += 1
	if combo > 5 then combo = 1 end

	-- Cooldown para evitar spam
	task.delay(delayGolpe, function()
		puedeAtacar = true
	end)
end

-- 📱 MOBILE: Detectar toque y golpear 1 vez
input.TouchTapInWorld:Connect(function()
	Golpear()
end)
